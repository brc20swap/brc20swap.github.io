import{j as me,ag as fe,af as xe,aO as be,a as u,l as te,w as _e,aX as ve,ah as x,ai as s,C as p,aj as y,ak as e,al as w,b3 as he,ay as ke,aC as se,aI as ye,an as m,aq as a,a8 as we,ap as f,am as oe,ao as ae,ax as O,au as ne,a4 as S,a5 as V,aw as U,as as ge,aB as Be,aF as Ie,ac as $e,aH as Te,aG as Fe,aJ as Ce,aK as Ne,aU as Re,ae as je,aL as Ae}from"./index-46f2f6cb.js";import{A as Se,F as Ve}from"./feeRate-d9442ab5.js";import{R as Ue,a as Me}from"./index-032dc785.js";const X=M=>(Ce("data-v-74b980bb"),M=M(),Ne(),M),ze={class:"page-container"},Ee={class:"page-content"},qe={class:"text-center text-24px"},De={class:"text-center color-#999 mt-6px mb-20px"},He={class:"flex items-stretch flex-wrap ml--5px mr--5px"},Le=["onClick"],We={class:"text-14px m-3px"},Ge=["disabled","onClick"],Je={class:"flex items-center justify-between w-100% pl-5px pr-5px mb-5px"},Ke={class:"text-12px color-#999"},Oe={key:1,class:"text-10px color-#333"},Xe={class:"text-12px color-#999 pt-5px w-100% border-t-1px mt-10px"},Pe=["disabled","onClick"],Qe={class:"flex items-center justify-between w-100% pl-5px pr-5px mb-5px"},Ye={class:"text-12px color-#999"},Ze={key:1,class:"text-10px color-#333"},et={class:"text-12px color-#999 pt-5px w-100% border-t-1px mt-10px"},tt={class:"flex justify-center color-#3F80F7 text-12px mt-5px"},st=["onClick"],ot={class:"mr-2px"},at=["onClick"],nt={class:"mr-2px"},lt={class:"mb-5px mt-20px"},it=X(()=>s("div",{class:"mb-5px mt-20px"},"Fee Rate",-1)),ct=X(()=>s("div",{class:"flex-1"},null,-1)),rt={key:0,class:"text-12px color-#999 flex items-center justify-center mt-10px"},pt={class:"mr-2px"},dt=["onClick"],ut={key:1,class:"flex items-center justify-between text-12px mt-10px"},mt={class:"color-#999"},ft={class:"color-#333"},xt={class:"flex items-center justify-between text-12px mt-10px"},bt={class:"color-#999"},_t=X(()=>s("span",{class:"flex-1"},null,-1)),vt={class:"color-#333"},ht={class:"text-14px color-#333 flex flex-col items-center pt-30px pb-30px pl-16px pr-16px"},kt={class:"mt-10px text-15px font-500"},yt={class:"mt-10px text-12px color-#999"},wt={class:"mt-10px text-14px color-#999 flex items-center justify-between w-100% mb-20px"},gt={class:"mr-5px"},Bt={class:"text-14px color-#333 flex flex-col items-center pt-30px pb-30px pl-16px pr-16px"},It={class:"mt-10px text-15px font-500"},$t={class:"mt-10px text-14px color-#999 flex items-center justify-between w-100% mb-20px"},Tt={class:"mr-5px"},Ft=me({__name:"transfer",setup(M){const l=fe(),{t:le}=xe(),P=be();let g=u(""),r=u(P.query.tick||""),b=u(P.query.toAddress||""),I=u({}),z=null;function Q(){r.value&&Re(r.value).then(t=>{console.log(t),I.value=t,z&&(clearTimeout(z),z=null),z=setTimeout(()=>{Q()},3e5)})}let c=u(""),E=u(!1),$=u(!1),W=u(5);function Y(){$.value=!$.value}let T=te(()=>{var t;return((t=l==null?void 0:l.brc20Balance)==null?void 0:t.transferableInscriptions)||[]}),G=te(()=>(T.value||[]).find(o=>c.value===o.inscriptionId));_e(r,t=>{t.length===4&&(c.value="",F(),Q())},{immediate:!0});let q=null;function F(){r.value&&r.value.length===4&&(l.walletAddress?l.getBrc20Balance(r.value).then(t=>{q&&(clearTimeout(q),q=null),q=setTimeout(()=>{F()},12e4)}):setTimeout(()=>{F()},3e3))}function ie(){l.getFees().then(t=>{g.value=l.fees.halfHourFee||""})}let C=u(!1),B=u("");function Z(){var t;l.checkWallet()&&((t=l==null?void 0:l.provider)==null||t.inscribeTransfer(r.value).then(o=>{console.log(o),typeof o=="string"?(B.value=o,C.value=!0):Be({message:le("transferSubmitted"),type:"success"}),setTimeout(()=>{F()},2e3)}).catch(o=>{console.log(o),se(o)}))}let N=u(!1),_=u("");function ce(){var t;l.checkWallet()&&b.value&&(E.value=!0,(t=l==null?void 0:l.provider)==null||t.sendInscription(b.value,c.value,{feeRate:Number(g.value||l.fees.hourFee||void 0)}).then(o=>{var v,R,H,L;console.log(o),o&&(_.value=o.txid,he("app_open_tx_detail",{amount:new ke(((R=(v=G.value)==null?void 0:v.data)==null?void 0:R.amt)||0).toFixed(0),from:l.walletAddress,to:b.value,symbol:((L=(H=I.value)==null?void 0:H.token)==null?void 0:L.symbol)||r,transactionHash:o.txid}),N.value=!0,setTimeout(()=>{c.value="",F()},2e3)),E.value=!1}).catch(o=>{console.log(o),E.value=!1,se(o)}))}function D(t){(t||_.value)&&Ie(`https://mempool.space/tx/${t||_.value}`)}function re(){ie()}return ve(()=>{re()}),(t,o)=>{const v=$e,R=Ue,H=Me,L=Te,pe=je,J=Fe,de=ye,ee=Se;return m(),x("div",ze,[s("div",Ee,[p(de,{class:"form-container text-14px color-#333 font-400",onSubmit:ce},{default:y(()=>{var i,h,d,k;return[s("div",qe,a(((h=(i=e(G))==null?void 0:i.data)==null?void 0:h.amt)||0)+" "+a(((k=(d=e(I))==null?void 0:d.token)==null?void 0:k.symbol)||e(r)),1),s("div",De,a(t.$t("transferableBalance"))+": "+a(e(l).brc20Balance.transferableBalance)+" "+a(e(r)),1),p(H,{class:"radio-group mb-10px",modelValue:e(c),"onUpdate:modelValue":o[0]||(o[0]=n=>w(c)?c.value=n:c=n)},{default:y(()=>[s("div",He,[s("button",{class:"flex flex-wrap items-center justify-center radio-btn clickable p-5px color-#999 min-h-80px important-p-5px",style:we({"min-width":(e(T)||[]).length===0?"calc(99% - 8px)":""}),type:"button",onClick:f(Z,["stop"])},[p(v,{name:"plus",size:"1.5em"}),s("span",We,a(t.$t("inscribeTransfer")),1)],12,Le),(m(!0),x(oe,null,ae((e(T)||[]).slice(0,e(W)),(n,K)=>{var j,A;return m(),x("button",{class:"flex flex-col items-center radio-btn",type:"button",disabled:n.confirmations<3,key:K,onClick:f(ue=>w(c)?c.value=n.inscriptionId:c=n.inscriptionId,["stop"])},[s("div",Je,[s("span",Ke,a(((A=(j=e(I))==null?void 0:j.token)==null?void 0:A.symbol)||e(r)),1),n.confirmations>=3?(m(),O(R,{key:0,disabled:n.confirmations<3,name:n.inscriptionId},null,8,["disabled","name"])):(m(),x("span",Oe,a(t.$t("unconfirmed")),1))]),s("span",null,a(e(ne)(n.data.amt)),1),s("span",Xe,a(`#${n.inscriptionNumber}`),1)],8,Ge)}),128)),(m(!0),x(oe,null,ae((e(T)||[]).slice(e(W)),(n,K)=>{var j,A;return S((m(),x("button",{class:"flex flex-col items-center radio-btn",type:"button",disabled:n.confirmations<3,key:K,onClick:f(ue=>w(c)?c.value=n.inscriptionId:c=n.inscriptionId,["stop"])},[s("div",Qe,[s("span",Ye,a(((A=(j=e(I))==null?void 0:j.token)==null?void 0:A.symbol)||e(r)),1),n.confirmations>=3?(m(),O(R,{key:0,disabled:n.confirmations<3,name:n.inscriptionId},null,8,["disabled","name"])):(m(),x("span",Ze,a(t.$t("unconfirmed")),1))]),s("span",null,a(e(ne)(n.data.amt)),1),s("span",et,a(`#${n.inscriptionNumber}`),1)],8,Pe)),[[V,e($)]])}),128))]),S(s("div",tt,[S(s("button",{class:"flex items-center",onClick:f(Y,["stop"]),type:"button"},[s("span",ot,a(t.$t("expandMore")),1),U(),p(v,{name:"arrow-down"})],8,st),[[V,!e($)]]),S(s("button",{class:"flex items-center",onClick:f(Y,["stop"]),type:"button"},[s("span",nt,a(t.$t("fold")),1),U(),p(v,{name:"arrow-up"})],8,at),[[V,e($)]])],512),[[V,(e(T)||[]).length>e(W)]])]),_:1},8,["modelValue"]),s("div",lt,a(t.$t("receiptAddress")),1),p(L,{class:"input-box",name:"toAddress",modelValue:e(b),"onUpdate:modelValue":o[1]||(o[1]=n=>w(b)?b.value=n:b=n),placeholder:t.$t("receiptAddress"),clearable:"",border:!1,rules:[{required:!0,message:t.$t("cannotBeEmpty")}]},null,8,["modelValue","placeholder","rules"]),it,p(Ve,{feeRate:e(g),"onUpdate:feeRate":o[2]||(o[2]=n=>w(g)?g.value=n:g=n)},null,8,["feeRate"]),ct,Number(e(l).brc20Balance.transferableBalance)===0?(m(),x("div",rt,[s("span",pt,a(t.$t("transferTips")),1),s("button",{class:"color-#3F80F7 clickable",type:"button",onClick:f(Z,["stop"])},a(t.$t("inscribeTransfer1")),9,dt)])):(m(),x("div",ut,[s("span",mt,a(t.$t("availableBalance")),1),s("span",ft,a(e(l).brc20Balance.availableBalanceSafe)+" "+a(e(r)),1)])),S(s("div",xt,[s("span",bt,a(t.$t("unsafeBalance")),1),_t,s("span",vt,a(e(l).brc20Balance.transferableBalanceUnconfirmed)+" "+a(e(r)),1),Number(e(l).brc20Balance.transferableBalanceUnconfirmed)!==0?(m(),O(pe,{key:0,class:"ml-5px",size:"0.4rem",color:"#3F80F7"})):ge("",!0)],512),[[V,Number(e(l).brc20Balance.transferableBalanceUnconfirmed)>0]]),p(J,{class:"submit-btn important-mt-20px",block:"",type:"primary","native-type":"submit",loading:e(E),disabled:!e(c)||!e(G)||!e(b),"loading-text":t.$t("confirm")},{default:y(()=>[U(a(t.$t("confirm")),1)]),_:1},8,["loading","disabled","loading-text"])]}),_:1})]),p(ee,{show:e(N),"onUpdate:show":o[5]||(o[5]=i=>w(N)?N.value=i:N=i),title:" "},{default:y(()=>{var i,h,d,k;return[s("div",ht,[p(v,{size:"3.4em",color:"#12B886",name:"checked"}),s("div",kt,a(t.$t("success")),1),s("div",yt,a(t.$t("transferSubmitted")),1),s("div",wt,[s("span",gt,a(t.$t("txId")),1),s("button",{class:"color-#558BED clickable van-multi-ellipsis--l2 flex-1",onClick:o[3]||(o[3]=f(n=>D(e(_)),["stop"]))},a(e(_)?((h=(i=e(_))==null?void 0:i.slice)==null?void 0:h.call(i,0,5))+"..."+((k=(d=e(_))==null?void 0:d.slice)==null?void 0:k.call(d,-5)):""),1)]),p(J,{color:"#3F80F7",block:"",class:"max-h-40px",onClick:o[4]||(o[4]=f(n=>D(e(_)),["stop"]))},{default:y(()=>[U(a(t.$t("viewTx")),1)]),_:1})])]}),_:1},8,["show"]),p(ee,{show:e(C),"onUpdate:show":o[8]||(o[8]=i=>w(C)?C.value=i:C=i),title:" "},{default:y(()=>{var i,h,d,k;return[s("div",Bt,[p(v,{size:"3.4em",color:"#12B886",name:"checked"}),s("div",It,a(t.$t("inscribeTransferSubmitted1")),1),s("div",$t,[s("span",Tt,a(t.$t("txId")),1),s("button",{class:"color-#558BED clickable van-multi-ellipsis--l2 flex-1",onClick:o[6]||(o[6]=f(n=>D(e(B)),["stop"]))},a(e(B)?((h=(i=e(B))==null?void 0:i.slice)==null?void 0:h.call(i,0,5))+"..."+((k=(d=e(B))==null?void 0:d.slice)==null?void 0:k.call(d,-5)):""),1)]),p(J,{color:"#3F80F7",block:"",class:"max-h-40px",onClick:o[7]||(o[7]=f(n=>D(e(B)),["stop"]))},{default:y(()=>[U(a(t.$t("viewTx")),1)]),_:1})])]}),_:1},8,["show"])])}}});const jt=Ae(Ft,[["__scopeId","data-v-74b980bb"]]);export{jt as default};
